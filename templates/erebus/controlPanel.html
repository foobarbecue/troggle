{% extends "base.html" %}
{% block content %}

{% if jobs_completed %}
    <div class="noticeBox">
            Just finished running:
                <ul>
                {% for job in jobs_completed %}
                    <li>{{ job }}</li>
                {% endfor %}
                </ul>
            {% if settings.LOGFILE %}See the logfile at {{settings.LOGFILE}} for more information.{% endif %}
            <a href="#" class="closeDiv">dismiss this message</a>
    </div>
{% endif %}

{% if error %}
    <div class="noticeBox">
			{{ error }}
            <a href="#" class="closeDiv">dismiss this message</a>
    </div>
{% endif %}


<form name="reset" method="post" action="">
<h3>Wipe:</h3>

<table>
<tr><td>Wipe entire database and recreate tables: </td><td><input type="checkbox" name="reload_db" /></td><td>      <input type="submit" id="Import" value="I really want to delete all information in troggle, and accept all responsibility."></td></tr>
</table>
</form>
<h3>Import (non-destructive):</h3>
<form name="import" method="post" action="">
<table>
<tr><td>people from folk.csv using parsers\people.py</td><td><input type="checkbox" name="import_people"/></td></tr>
<tr><td>caves from cavetab2.csv using parsers\cavetab.py</td><td> <input type="checkbox" class="parser" name="import_cavetab"/></td></tr>
<tr><td>logbook entries using parsers\logbooks.py</td><td><input type="checkbox" name="import_logbooks"/></td></tr>
<tr><td>QMs using parsers\QMs.py</td><td><input type="checkbox" name="import_QMs" /></td></tr>
<tr><td>survey scans using parsers\surveys.py</td><td><input type="checkbox" name="import_surveys" /></td></tr>
<tr><td>survex data using parsers\survex.py</td><td><input type="checkbox" name="import_survex" /></td></tr>

</table>


    <p>
      <input type="submit" id="Import" value="Import">
      
      <input type="submit" name="check_all_import" id="check_all_import" value="Check all" disabled >
    </p>
</form>


<h3>Export to legacy formats:</h3>
<table>

<th>
    <td>Export onto server</td>
    <td>Export and Download</td>
</th>
<tr>
  	<td>
    	caves to cavetab2.csv
    </td>
  	<td>
        <form name="export" method="post" action="">
        	<p>Overwrite the existing CAVETAB2.CSV file with one generated by Troggle.</p>
            <input name="export_cavetab" type="submit" value="Update {{settings.EXPOWEB}}noinfo/CAVETAB2.CSV" />
        </form>
    </td>
    <td>
        <form name="export" method="get" action="{% url downloadcavetab %}">
        	<p>Download a CAVETAB2.CSV file which is dynamically generated by Troggle.</p>
            <input name="download_cavetab" type="submit" value="Download CAVETAB2.CSV" />
        </form>
	</td>        
</tr>

<tr>
  	<td>
    	surveys to Surveys.csv
    </td>
  	<td>

    </td>
    <td>
        <form name="export" method="get" action={% url downloadlogbook %}>
        	<p>Download a logbook file which is dynamically generated by Troggle.</p>
			
            <p>
            Expedition year:
            <select name="year">
                        {% for expedition in expeditions %}
                        	<option value="{{expedition}}"> {{expedition}} </option>
                        {% endfor %}
            </select>
            </p>
            
            <p>
            Output style: 
			<select name="extension">
			  <option value="txt">.txt file with MediaWiki markup - 2008 style</option>
			  <option value="html">.html file - 2005 style</option>
            </select>
            </p>
            <p>
            <input name="download_logbook" type="submit" value="Download logbook" />
            </p>
        </form>
	</td>        
</tr>

<tr>
  	<td>
    	surveys to Surveys.csv
    </td>
  	<td>
        <form name="export" method="post" action="">
        	<p>Overwrite the existing Surveys.csv file with one generated by Troggle.</p>
            <input disabled name="export_surveys" type="submit" value="Update {{settings.SURVEYS}}noinfo/Surveys.csv" />
        </form>
    </td>
    <td>
        <form name="export" method="get" action={% url downloadsurveys %}>
        	<p>Download a Surveys.csv file which is dynamically generated by Troggle.</p>
            <input disabled name="download_surveys" type="submit" value="Download Surveys.csv" />
        </form>
	</td>        
</tr>
  
<tr>
  <td>qms to qms.csv</td><td>
  	<form name="export_qms" method="get" action="downloadqms">
		
<!--This is for choosing caves by area (drilldown).

        <select id="qmcaveareachooser" class="searchable" >
        </select>
        
        -->

		Choose a cave.
        <select name="cave_id" id="qmcavechooser">
        
            {% for cave in caves %}
            <option value="{{cave.kataster_number}}">{{cave}}
            </option>    	
            {% endfor %}
    
        </select>

        <input type="submit" value="Download"/>
    </form>
  </td></tr>  
</table>
</form>

{% endblock %}	