{% extends "base.html" %}
{% load wiki_markup %}

{% block title %}Logbook {{logbookentry.id}}{% endblock %}

{% block content %}
<h2>{{logbookentry.title|safe}}</h2>

<div id="col2">
<p><a href="{% url expedition logbookentry.expedition.year %}">{{logbookentry.expedition.name}}</a></p>

{% if logbookentry.cave %}
  <p>place: <a href="{% url cave logbookentry.cave.href %}">{{logbookentry.place}}</p>
{% else %}
  <p>{{logbookentry.place}}</p>
{% endif %}

<p>
  {% if logbookentry.get_previous_by_date %}
    <a href="{% url logbookentry logbookentry.get_previous_by_date.href %}">{{logbookentry.get_previous_by_date.date}}</a>
  {% endif %}
  {% if logbookentry.get_next_by_date %}
    <a href="{% url logbookentry logbookentry.get_next_by_date.href %}">{{logbookentry.get_next_by_date.date}}</a>
  {% endif %}
</p>

<table class="cavers">
<tr><th>Caver</th><th>T/U</th><th>Prev</th><th>Next</th></tr>
{% for persontrip in logbookentry.persontrip_set.all %}
<tr>
  {% ifequal persontrip.person_expedition logbookentry.author %}
    <td class="author">
  {% else %}
    <td>
  {% endifequal %}
  <a href="{% url personexpedition persontrip.person_expedition.person.href persontrip.person_expedition.expedition.year %}">{{persontrip.person_expedition.person}}</a>
  </td>
  
  <td>
  {% if persontrip.timeunderground %}
     - T/U {{persontrip.timeunderground}}</p>
  {% endif %}
  </td>

  <td>
  {% if persontrip.get_previous_by_date %}
    <a href="{% url logbookentry persontrip.get_previous_by_date.logbook_entry.href %}">{{persontrip.get_previous_by_date.date}}</a>
  {% endif %}
  </td>
  <td>
  {% if persontrip.get_next_by_date %}
     <a href="{% url logbookentry persontrip.get_next_by_date.logbook_entry.href %}">{{persontrip.get_next_by_date.date}}</a>
  {% endif %}
  </td>
</tr>
{% endfor %}
</table>
</div>

<div id="col1">
<div class="logbookentry">
<b>{{logbookentry.date}}</b>
    {{logbookentry.text|wiki_to_html}}</div>
</div>
</div>

{% endblock %}
