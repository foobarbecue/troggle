{% extends "base.html" %}
{% load wiki_markup %}

{% block title %}Person {{personexpedition.person|wiki_to_html_short}} for {{personexpedition.expedition}}{% endblock %}


{% block content %}
<h2>{{personexpedition.person}}: {{personexpedition.expedition}} ({{personexpedition.date_from}} - {{personexpedition.date_to}})</h2>

<h3>{{message}}</h3>

<p><b><a href="{% url expedition personexpedition.expedition.year %}">Main page for expedition: {{personexpedition.expedition}}</a></b></p>
<p><b><a href="{% url person personexpedition.person.href %}">Main page for person: {{personexpedition.person}}</a></b></p>

<p>List of other expos by this person</p>
<p>
{% for otherpersonexpedition in personexpedition.person.personexpedition_set.all %}
{% ifequal otherpersonexpedition personexpedition %}
  | <b>{{otherpersonexpedition.expedition.year}}</b>
{% else %}
  | <a href="{% url personexpedition personexpedition.person.href otherpersonexpedition.expedition.year %}">{{otherpersonexpedition.expedition.year}}</a>
{% endifequal %}
{% endfor %}
</p>

<h3>Table of all trips and surveys aligned by date</h3>
<div>
<table class="survexcontibutions">
<tr><th>Date</th><th>Trips</th><th>Surveys</th></tr>
{% for persondate in personexpedition.GetPersonChronology %}
<tr>
  <td class="date">{{persondate.0}}</td>

  <td> 
    <table>
    {% for persontrip in persondate.1.persontrips %}
      <tr>
        <td class="trip"><a href="{% url logbookentry persontrip.logbook_entry.href %}">{{persontrip.logbook_entry.title|safe}}</a></td>
        <td class="place">{{persontrip.place}}</td>
      </tr>
    {% endfor %}
    </table>
  </td>
  
  <td>
    <table>
    {% for personsurvexroles in persondate.1.personroles.items %}
      <tr>
        <td class="survexblock"><a href="{% url survexblock personsurvexroles.0 %}">{{personsurvexroles.0}}</a></td>
        <td class="roles">{{personsurvexroles.1}}</td>
      </tr>
    {% endfor %}
    </table>
  </td>

</tr>
{% endfor %}
</table>
</div>

{% endblock %}
